#! /bin/sh
#
# Copyright 2012-2013 Nils Nordman <nino at nordman.org>
# License: MIT (see LICENSE)

ROOT=$(cd $(dirname $0)/.. && pwd)
for howl in $ROOT/bin/howl $ROOT/src/howl; do
  if [ -e $howl ]; then
    HOWL=$howl
    break
  fi
done

if [ -z "$HOWL" ]; then
  echo "Could not locate howl executable"
  exit 1
fi

if command -v busted > /dev/null 2>/dev/null; then
  export BUSTED='yes'
  exec busted -l $HOWL --pattern=_spec.moon $*
else
  cat <<ERR
Error: 'busted' command not found
---------------------------------

To run $0 you need to have the busted testing framework installed.
The easiest way of doing this is to install luarocks, and execute:

$ luarocks install busted

luarocks might be available from your package manager, or you can install
it using the instructions from http://luarocks.org
ERR
  exit 1
fi
